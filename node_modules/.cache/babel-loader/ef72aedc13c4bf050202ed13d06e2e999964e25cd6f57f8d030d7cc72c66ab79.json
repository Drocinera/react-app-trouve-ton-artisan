{"ast":null,"code":"import React,{useState}from\"react\";import{useParams}from\"react-router-dom\";import data from\"../datas.json\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const FicheArtisan=()=>{const{id}=useParams();const artisan=data.find(item=>item.id===id);// Initialisation de la validation du formulaire\nReact.useEffect(()=>{const forms=document.querySelectorAll('.needs-validation');Array.from(forms).forEach(form=>{form.addEventListener('submit',event=>{if(!form.checkValidity()){event.preventDefault();event.stopPropagation();}form.classList.add('was-validated');},false);});},[]);const[formValues,setFormValues]=useState({nom:'',prénom:'',email:'',sujet:'',message:''});const[emailSent,setEmailSent]=useState(false);const[errorMessage,setErrorMessage]=useState(\"\");const handleChange=event=>{const{name,value}=event.target;setFormValues(prevValues=>({...prevValues,[name]:value}));};const handleSubmit=async event=>{event.preventDefault();if(!event.target.checkValidity()){event.stopPropagation();return;}const formData={...formValues,artisanEmail:artisan.email};try{const response=await fetch('http://localhost:3000/send-email',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(formData)});if(response.ok){setEmailSent(true);setErrorMessage(\"\");setFormValues({nom:'',prénom:'',email:'',sujet:'',message:''});}else{const result=await response.json();setErrorMessage(result.message||\"Une erreur s'est produite lors de l'envoi de l'email.\");}}catch(error){console.error('Error sending email:',error);setErrorMessage(\"Une erreur s'est produite lors de l'envoi de l'email.\");}};if(!artisan){return/*#__PURE__*/_jsx(\"div\",{children:\"Artisan non trouv\\xE9\"});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Contacter \",artisan.name]}),/*#__PURE__*/_jsxs(\"form\",{className:\"needs-validation\",noValidate:true,onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"nom\",className:\"form-label\",children:\"Nom\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",id:\"nom\",name:\"nom\",value:formValues.nom,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"invalid-feedback\",children:\"Veuillez entrer votre nom.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"pr\\xE9nom\",className:\"form-label\",children:\"Pr\\xE9nom\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",id:\"pr\\xE9nom\",name:\"pr\\xE9nom\",value:formValues.prénom,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"invalid-feedback\",children:\"Veuillez entrer votre pr\\xE9nom.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",className:\"form-label\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"form-control\",id:\"email\",name:\"email\",value:formValues.email,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"invalid-feedback\",children:\"Veuillez entrer une adresse email valide.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"sujet\",className:\"form-label\",children:\"Sujet\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",id:\"sujet\",name:\"sujet\",value:formValues.sujet,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"invalid-feedback\",children:\"Veuillez entrer le sujet de votre message.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"message\",className:\"form-label\",children:\"Message\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"form-control\",id:\"message\",name:\"message\",rows:\"3\",value:formValues.message,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"invalid-feedback\",children:\"Veuillez entrer votre message.\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",children:\"Envoyer\"})]}),emailSent&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-success mt-3\",children:\"Email envoy\\xE9 avec succ\\xE8s!\"}),errorMessage&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger mt-3\",children:errorMessage})]});};export default FicheArtisan;","map":{"version":3,"names":["React","useState","useParams","data","jsx","_jsx","jsxs","_jsxs","FicheArtisan","id","artisan","find","item","useEffect","forms","document","querySelectorAll","Array","from","forEach","form","addEventListener","event","checkValidity","preventDefault","stopPropagation","classList","add","formValues","setFormValues","nom","prénom","email","sujet","message","emailSent","setEmailSent","errorMessage","setErrorMessage","handleChange","name","value","target","prevValues","handleSubmit","formData","artisanEmail","response","fetch","method","headers","body","JSON","stringify","ok","result","json","error","console","children","className","noValidate","onSubmit","htmlFor","type","onChange","required","rows"],"sources":["C:/Users/theop/OneDrive/Documents/programmeur/TrouveTonArtisan-React-App/react-app-trouve-ton-artisan/src/Components/FicheArtisan.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport data from \"../datas.json\";\r\n\r\nconst FicheArtisan = () => {\r\n  const { id } = useParams();\r\n  const artisan = data.find(item => item.id === id);\r\n\r\n  // Initialisation de la validation du formulaire\r\n  React.useEffect(() => {\r\n    const forms = document.querySelectorAll('.needs-validation');\r\n\r\n    Array.from(forms).forEach(form => {\r\n      form.addEventListener('submit', event => {\r\n        if (!form.checkValidity()) {\r\n          event.preventDefault();\r\n          event.stopPropagation();\r\n        }\r\n\r\n        form.classList.add('was-validated');\r\n      }, false);\r\n    });\r\n  }, []);\r\n  \r\n  const [formValues, setFormValues] = useState({\r\n    nom: '',\r\n    prénom: '',\r\n    email: '',\r\n    sujet: '',\r\n    message: ''\r\n  });\r\n\r\n  const [emailSent, setEmailSent] = useState(false);\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n\r\n  const handleChange = (event) => {\r\n    const { name, value } = event.target;\r\n    setFormValues(prevValues => ({\r\n      ...prevValues,\r\n      [name]: value\r\n    }));\r\n  };\r\n\r\n  const handleSubmit = async (event) => {\r\n    event.preventDefault();\r\n    if (!event.target.checkValidity()) {\r\n      event.stopPropagation();\r\n      return;\r\n    }\r\n\r\n    const formData = { ...formValues, artisanEmail: artisan.email };\r\n\r\n    try {\r\n      const response = await fetch('http://localhost:3000/send-email', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(formData),\r\n      });\r\n\r\n      if (response.ok) {\r\n        setEmailSent(true);\r\n        setErrorMessage(\"\");\r\n        setFormValues({\r\n          nom: '',\r\n          prénom: '',\r\n          email: '',\r\n          sujet: '',\r\n          message: ''\r\n        });\r\n      } else {\r\n        const result = await response.json();\r\n        setErrorMessage(result.message || \"Une erreur s'est produite lors de l'envoi de l'email.\");\r\n      }\r\n    } catch (error) {\r\n      console.error('Error sending email:', error);\r\n      setErrorMessage(\"Une erreur s'est produite lors de l'envoi de l'email.\");\r\n    }\r\n  };\r\n\r\n  if (!artisan) {\r\n    return <div>Artisan non trouvé</div>;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h2>Contacter {artisan.name}</h2>\r\n      <form className=\"needs-validation\" noValidate onSubmit={handleSubmit}>\r\n        <div className=\"mb-3\">\r\n          <label htmlFor=\"nom\" className=\"form-label\">Nom</label>\r\n          <input \r\n            type=\"text\"\r\n            className=\"form-control\"\r\n            id=\"nom\"\r\n            name=\"nom\"\r\n            value={formValues.nom}\r\n            onChange={handleChange}\r\n            required\r\n          />\r\n          <div className=\"invalid-feedback\">\r\n            Veuillez entrer votre nom.\r\n          </div>\r\n        </div>\r\n        <div className=\"mb-3\">\r\n          <label htmlFor=\"prénom\" className=\"form-label\">Prénom</label>\r\n          <input\r\n            type=\"text\"\r\n            className=\"form-control\"\r\n            id=\"prénom\"\r\n            name=\"prénom\"\r\n            value={formValues.prénom}\r\n            onChange={handleChange}\r\n            required\r\n          />\r\n          <div className=\"invalid-feedback\">\r\n            Veuillez entrer votre prénom.\r\n          </div>\r\n        </div>\r\n        <div className=\"mb-3\">\r\n          <label htmlFor=\"email\" className=\"form-label\">Email</label>\r\n          <input\r\n            type=\"email\"\r\n            className=\"form-control\"\r\n            id=\"email\"\r\n            name=\"email\"\r\n            value={formValues.email}\r\n            onChange={handleChange}\r\n            required\r\n          />\r\n          <div className=\"invalid-feedback\">\r\n            Veuillez entrer une adresse email valide.\r\n          </div>\r\n        </div>\r\n        <div className=\"mb-3\">\r\n          <label htmlFor=\"sujet\" className=\"form-label\">Sujet</label>\r\n          <input\r\n            type=\"text\"\r\n            className=\"form-control\"\r\n            id=\"sujet\"\r\n            name=\"sujet\"\r\n            value={formValues.sujet}\r\n            onChange={handleChange}\r\n            required\r\n          />\r\n          <div className=\"invalid-feedback\">\r\n            Veuillez entrer le sujet de votre message.\r\n          </div>\r\n        </div>\r\n        <div className=\"mb-3\">\r\n          <label htmlFor=\"message\" className=\"form-label\">Message</label>\r\n          <textarea\r\n            className=\"form-control\"\r\n            id=\"message\"\r\n            name=\"message\"\r\n            rows=\"3\"\r\n            value={formValues.message}\r\n            onChange={handleChange}\r\n            required\r\n          ></textarea>\r\n          <div className=\"invalid-feedback\">\r\n            Veuillez entrer votre message.\r\n          </div>\r\n        </div>\r\n        <button type=\"submit\" className=\"btn btn-primary\">Envoyer</button>\r\n      </form>\r\n      {emailSent && <div className=\"alert alert-success mt-3\">Email envoyé avec succès!</div>}\r\n      {errorMessage && <div className=\"alert alert-danger mt-3\">{errorMessage}</div>}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FicheArtisan;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}